FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG51eGVvLWFyZW5kZXItcHJldmlld2VyLWFwYgpkZXNjcmlwdGlv\
bjogQVJlbmRlciBQcmV2aWV3ZXIgZGVwbG95bWVudCBpbiBPcGVuc2hpZnQgZm9yIE51eGVvCmJp\
bmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOgogIC0gbnV4ZW8KICAtIGFyZW5kZXIK\
bWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IEFSZW5kZXIgUHJldmlld2VyIGVudmlyb25tZW50IGZv\
ciBOdXhlbwogIGltYWdlVXJsOiAiaHR0cHM6Ly93d3cubnV4ZW8uY29tL2Fzc2V0cy9pbWdzL2xv\
Z28zNDB4NjAucG5nIgogIGxvbmdEZXNjcmlwdGlvbjoKICAgIFRoaXMgRGVwbG95cyBhbiBBUmVu\
ZGVyIHByZXZpZXdlciBlbnZpcm9ubWVudCB0aGF0IGNhbiBiZSB1c2VkIHdpdGggTnV4ZW8KICBk\
ZXBlbmRlbmNpZXM6IFtdCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIk51eGVvIgpwbGFuczoKICAt\
IG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBEZWZhdWx0IEFSZW5kZXIgcHJldmlld2Vy\
IGRlcGxveW1lbnQKICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVy\
czoKICAgIC0gbmFtZTogcHJvamVjdF9uYW1lCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRs\
ZTogUHJvamVjdCBOYW1lCiAgICAgIGRlZmF1bHQ6IGFyZW5kZXIKICAgICAgZGlzcGxheV9ncm91\
cDogUHJvamVjdCBwcm9wZXJ0aWVzCgogICAgLSBuYW1lOiBwcmV2aWV3ZXJfbnV4ZW9fdXJsCiAg\
ICAgIGRlZmF1bHQ6ICdodHRwczovL251eGVvLnVybC9udXhlbycKICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgIHRpdGxlOiBVcmwgb2YgdGhlIE51eGVvIGNsaWVudAogICAgICBkaXNwbGF5X2dyb3Vw\
OiBDbGllbnQgTnV4ZW8KICAgIC0gbmFtZTogcHJldmlld2VyX251eGVvX2NsaWVudF90aW1lb3V0\
CiAgICAgIGRlZmF1bHQ6IDYwCiAgICAgIHR5cGU6IG51bWJlcgogICAgICB0aXRsZTogVGltZW91\
dCBmb3IgdGhlIE51eGVvIENsaWVudAogICAgICBkaXNwbGF5X2dyb3VwOiBDbGllbnQgTnV4ZW8K\
ICAgIC0gbmFtZTogcHJldmlld2VyX2FyZW5kZXJfbWF4X3RyaWVzCiAgICAgIGRlZmF1bHQ6IDIK\
ICAgICAgdHlwZTogbnVtYmVyCiAgICAgIHRpdGxlOiBOdW1iZXIgb2YgcmV0cmllcyBmb3IgQVJl\
bmRlciBobWkgdG8gYXNrIGZvciBhIHJlbmRpdGlvbiBjYWxsCiAgICAgIGRpc3BsYXlfZ3JvdXA6\
IENsaWVudCBOdXhlbwogICAgLSBuYW1lOiBwcmV2aWV3ZXJfYXJlbmRlcl9yZXN0X2Nvbm5lY3Rp\
b25fcG9vbF91c2UKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgICB0eXBlOiBib29sZWFuCiAgICAg\
IHRpdGxlOiBXaGV0aGVyIG9yIG5vdCB0byB1c2UgdGhlIGh0dHAgY29ubmVjdGlvbiBwb29sIGZv\
ciByZW5kaXRpb24gY2FsbHMKICAgICAgZGlzcGxheV9ncm91cDogQ2xpZW50IE51eGVvCiAgICAt\
IG5hbWU6IHByZXZpZXdlcl9hcmVuZGVyX3Jlc3RfY29ubmVjdGlvbl9wb29sX21heF90b3RhbAog\
ICAgICBkZWZhdWx0OiAxMDAKICAgICAgdHlwZTogbnVtYmVyCiAgICAgIHRpdGxlOiBNYXhpbXVt\
IG51bWJlciBvZiBodHRwIGNvbm5lY3Rpb25zIGluIHRoZSBwb29sCiAgICAgIGRpc3BsYXlfZ3Jv\
dXA6IENsaWVudCBOdXhlbwogICAgLSBuYW1lOiBwcmV2aWV3ZXJfYXJlbmRlcl9yZXN0X2xvbmdf\
dGltZW91dAogICAgICBkZWZhdWx0OiA2MDAwMAogICAgICB0eXBlOiBudW1iZXIKICAgICAgdGl0\
bGU6IFRpbWVvdXQgZm9yIHJlbmRpdGlvbiBjYWxscyBtYWRlIGJ5IEFSZW5kZXIgaG1pCiAgICAg\
IGRpc3BsYXlfZ3JvdXA6IENsaWVudCBOdXhlbwogICAgLSBuYW1lOiBwcmV2aWV3ZXJfbnV4ZW9f\
b2F1dGhfc2VjcmV0CiAgICAgIGRlZmF1bHQ6ICdPQVVUSDJfU0VDUkVUJwogICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgdGl0bGU6IFNoYXJlZCBzZWNyZXQgZm9yIE9BdXRoMiBleGNoYW5nZQogICAg\
ICBkaXNwbGF5X2dyb3VwOiBDbGllbnQgTnV4ZW8KCiAgICAtIG5hbWU6IGFyZW5kZXJfcmVuZGl0\
aW9uX3NlcnZpY2VfbmFtZQogICAgICBkZWZhdWx0OiBhcmVuZGVyLXBvb2wtMQogICAgICB0eXBl\
OiBzdHJpbmcKICAgICAgdGl0bGU6IE5hbWUgb3IgdGhlIHJlbmRpdGlvbiBzZXJ2aWNlIHRvIHVz\
ZQogICAgICBkaXNwbGF5X2dyb3VwOiBBUmVuZGVyIFJlbmRpdGlvbiBCaW5kaW5nCgogICAgLSBu\
YW1lOiBhcmVuZGVyX3ByZXZpZXdlcl9pbWFnZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0\
bGU6IEFSZW5kZXIgcHJldmlld2VyIGltYWdlCiAgICAgIGRlZmF1bHQ6IGRvY2tlci1yZWdpc3Ry\
eS5kZWZhdWx0LnN2Yzo1MDAwL2NvbW1vbi1pbmZyYS9hcmVuZGVyLXByZXZpZXdlcgogICAgICBk\
aXNwbGF5X2dyb3VwOiBDb250YWluZXIgSW1hZ2UKICAgIC0gbmFtZTogYXJlbmRlcl9wcmV2aWV3\
ZXJfaW1hZ2VfdmVyc2lvbgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IEFSZW5kZXIg\
cHJldmlld2VyIGltYWdlIHZlcnNpb24KICAgICAgZGVmYXVsdDogIjEwLjMuNSIKICAgICAgZGlz\
cGxheV9ncm91cDogQ29udGFpbmVyIEltYWdlCgogICAgLSBuYW1lOiBhcmVuZGVyX3ByZXZpZXdl\
cl9pbWFnZV9wdWxsX2V4aXN0aW5nX3NlY3JldAogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0\
bGU6IE5hbWUgb2Ygc2VjcmV0IHRvIHVzZSB0byBwdWxsIGltYWdlIChMZWF2ZSBlbXB0eSBpZiB5\
b3V0IHdhbnQgdG8gdXNlIHVzZXIvcGFzc3dvcmQpCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRh\
aW5lciBJbWFnZQogICAgLSBuYW1lOiBhcmVuZGVyX3ByZXZpZXdlcl9pbWFnZV9wdWxsX2hvc3QK\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBEb2NrZXIgcmVwb3NpdG9yeSB0byB1c2Ug\
Zm9yIHNlY3JldAogICAgICBkZWZhdWx0OiBkb2NrZXItcmVnaXN0cnkuZGVmYXVsdC5zdmM6NTAw\
MAogICAgICBkaXNwbGF5X2dyb3VwOiBDb250YWluZXIgSW1hZ2UKICAgIC0gbmFtZTogYXJlbmRl\
cl9wcmV2aWV3ZXJfaW1hZ2VfcHVsbF91c2VybmFtZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAg\
dGl0bGU6IFVzZXJuYW1lIHRvIHVzZSB0byBwdWxsIHRoZSBEb2NrZXIgaW1hZ2UKICAgICAgZGVm\
YXVsdDogbnV4ZW8KICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIEltYWdlCiAgICAtIG5h\
bWU6IGFyZW5kZXJfcHJldmlld2VyX2ltYWdlX3B1bGxfcGFzc3dvcmQKICAgICAgdHlwZTogc3Ry\
aW5nCiAgICAgIHRpdGxlOiBQYXNzd29yZCB0byB1c2UgdG8gcHVsbCB0aGUgRG9ja2VyIGltYWdl\
CiAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgZGlzcGxheV9ncm91cDogQ29udGFp\
bmVyIEltYWdlCgogICAgLSBuYW1lOiBwcmV2aWV3ZXJfaW1hZ2VfcHVsbFBvbGljeQogICAgICBk\
ZWZhdWx0OiAnSWZOb3RQcmVzZW50JwogICAgICB0eXBlOiBlbnVtCiAgICAgIGVudW06IFsnSWZO\
b3RQcmVzZW50JywgJ0Fsd2F5cycsICdOZXZlciddCiAgICAgIHRpdGxlOiBBUmVuZGVyIFByZXZp\
ZXdlciBpbWFnZSBwdWxsIHBvbGljeQogICAgICBkaXNwbGF5X2dyb3VwOiBDb250YWluZXIgU3Bl\
Y3MKCiAgICAtIG5hbWU6IHBlcnNpc3RlbnRWb2x1bWVfc3RvcmFnZUNsYXNzCiAgICAgIGRlZmF1\
bHQ6ICdzaGFyZWQnCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogU3RvcmFnZSBjbGFz\
c2UgbmFtZSAobXVzdCBiZSBjYXBhYmxlIG9mIFJXWCkKICAgICAgZGlzcGxheV9ncm91cDogQ29u\
dGFpbmVyIFNwZWNzCgogICAgLSBuYW1lOiBwcmV2aWV3ZXJfcmVzb3VyY2VzCiAgICAgIGRlZmF1\
bHQ6ICd7ImxpbWl0cyI6IHsiY3B1IjogIjIiLCJtZW1vcnkiOiAiNEdpIn0sInJlcXVlc3RzIjog\
eyJjcHUiOiAiMSIsIm1lbW9yeSI6ICIzR2kifX0nCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0\
aXRsZTogUHJldmlld2VyIFBvZCByZXNvdXJjZSByZXF1ZXN0cyBhbmQgbGltaXRzCiAgICAgIGRp\
c3BsYXlfdHlwZTogdGV4dGFyZWEKICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIFNwZWNz\
CgogICAgLSBuYW1lOiBhcmVuZGVyX3ByZXZpZXdlcl9oYQogICAgICBkZWZhdWx0OiBmYWxzZQog\
ICAgICB0eXBlOiBib29sZWFuCiAgICAgIHRpdGxlOiBFbmFibGUgSGlnaCBhdmFpbGFiaWxpdHkK\
ICAgICAgZGlzcGxheV9ncm91cDogQXV0b3NjYWxpbmcKCiAgICAtIG5hbWU6IGFyZW5kZXJfYXV0\
b3NjYWxpbmdfbWluCiAgICAgIGRlZmF1bHQ6IDEKICAgICAgdHlwZTogbnVtYmVyCiAgICAgIHRp\
dGxlOiBBdXRvc2NhbGluZyBNaW5pbXVtIHJlcGxpY2FzCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEF1\
dG9zY2FsaW5nCiAgICAtIG5hbWU6IGFyZW5kZXJfYXV0b3NjYWxpbmdfbWF4CiAgICAgIGRlZmF1\
bHQ6IDEKICAgICAgdHlwZTogbnVtYmVyCiAgICAgIHRpdGxlOiBBdXRvc2NhbGluZyBNYXhpbXVt\
IHJlcGxpY2FzCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEF1dG9zY2FsaW5nCiAgICAtIG5hbWU6IGFy\
ZW5kZXJfYXV0b3NjYWxpbmdfdGFyZ2V0Q1BVCiAgICAgIGRlZmF1bHQ6IDgwCiAgICAgIHR5cGU6\
IG51bWJlcgogICAgICB0aXRsZTogQXV0b3NjYWxpbmcgVGFyZ2V0IENQVSBVc2FnZSBwZXJjZW50\
YWdlCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEF1dG9zY2FsaW5nCgogICAgLSBuYW1lOiBhcmVuZGVy\
X3ByZXZpZXdlcl9nd190aW1lb3V0X2luX3NlY29uZHMKICAgICAgZGVmYXVsdDogIjEyMHMiCiAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogR2F0ZXdheSB0aW1lb3V0CiAgICAgIGRpc3Bs\
YXlfZ3JvdXA6IE90aGVycwoKICAgIC0gbmFtZTogYXJlbmRlcl9wcmV2aWV3ZXJfbW9uaXRvcmlu\
Z19lbmFibGVkCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgIHR5cGU6IGJvb2xlYW4KICAgICAg\
ZGlzcGxheV90eXBlOiBjaGVja2JveAogICAgICB0aXRsZTogRW5hYmxlIE1vbml0b3Jpbmcgc3Rh\
Y2sKICAgICAgZGlzcGxheV9ncm91cDogTW9uaXRvcmluZwoKICAgIC0gbmFtZTogYXJlbmRlcl9w\
cmV2aWV3ZXJfbW9uaXRvcmluZ19lc19zZXJ2aWNlCiAgICAgIGRlZmF1bHQ6IGFyZW5kZXItbW9u\
aXRvci1lbGFzdGljc2VhcmNoCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogTmFtZSBv\
ZiB0aGUgRVMgc2VydmljZSBpbnN0YW5jZQogICAgICBkaXNwbGF5X2dyb3VwOiBNb25pdG9yaW5n\
CgogICAgLSBuYW1lOiBhcmVuZGVyX3ByZXZpZXdlcl9tb25pdG9yaW5nX2tpYmFuYV9zZXJ2aWNl\
CiAgICAgIGRlZmF1bHQ6IGFyZW5kZXItbW9uaXRvci1raWJhbmEKICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgIHRpdGxlOiBOYW1lIG9mIHRoZSBLaWJhbmEgc2VydmljZSBpbnN0YW5jZQogICAgICBk\
aXNwbGF5X2dyb3VwOiBNb25pdG9yaW5nCgogICAgLSBuYW1lOiBhcmVuZGVyX3ByZXZpZXdlcl9t\
b25pdG9yaW5nX2RhdGFkb2dfZW5hYmxlZAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgICB0eXBl\
OiBib29sZWFuCiAgICAgIGRpc3BsYXlfdHlwZTogY2hlY2tib3gKICAgICAgdGl0bGU6IEVuYWJs\
ZSBEYXRhZG9nIGFnZW50CiAgICAgIGRpc3BsYXlfZ3JvdXA6IE1vbml0b3JpbmcKCiAgICAtIG5h\
bWU6IGFyZW5kZXJfcHJldmlld2VyX21vbml0b3JpbmdfZGF0YWRvZ19rZXkKICAgICAgZGVmYXVs\
dDogJycKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBEYXRhZG9nIEFQSSBLZXkKICAg\
ICAgZGlzcGxheV9ncm91cDogTW9uaXRvcmluZwoKICAgIC0gbmFtZTo6IGFyZW5kZXJfcHJldmll\
d2VyX21vbml0b3JpbmdfZGF0YWRvZ190YWdzCiAgICAgIGRlZmF1bHQ6ICd7InN0YWdpbmciOiAi\
ZGV2IiwgInByb2plY3QiOiAiaW50ZXJuYWwifScKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRp\
dGxlOiBEYXRhZG9nIEFkZGl0aW9uYWwgVGFncwogICAgICBkaXNwbGF5X2dyb3VwOiBNb25pdG9y\
aW5nCg=="

ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/nuxeo-arender-apb/
ADD . /opt/ansible/roles/nuxeo-arender-previewer-apb/

RUN chmod -R g=u /opt/{ansible,apb}

USER apb
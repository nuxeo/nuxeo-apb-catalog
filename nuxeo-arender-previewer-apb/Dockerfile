FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG51eGVvLWFyZW5kZXItcHJldmlld2VyLWFwYgpkZXNjcmlwdGlv\
bjogQVJlbmRlciBQcmV2aWV3ZXIgZGVwbG95bWVudCBpbiBPcGVuc2hpZnQgZm9yIE51eGVvCmJp\
bmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOgogIC0gbnV4ZW8KICAtIGFyZW5kZXIK\
bWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IEFSZW5kZXIgUHJldmlld2VyIGVudmlyb25tZW50IGZv\
ciBOdXhlbwogIGltYWdlVXJsOiAiaHR0cHM6Ly93d3cubnV4ZW8uY29tL2Fzc2V0cy9pbWdzL2xv\
Z28zNDB4NjAucG5nIgogIGxvbmdEZXNjcmlwdGlvbjoKICAgIFRoaXMgRGVwbG95cyBhbiBBUmVu\
ZGVyIHByZXZpZXdlciBlbnZpcm9ubWVudCB0aGF0IGNhbiBiZSB1c2VkIHdpdGggTnV4ZW8KICBk\
ZXBlbmRlbmNpZXM6IFtdCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIk51eGVvIgpwbGFuczoKICAt\
IG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBEZWZhdWx0IEFSZW5kZXIgcHJldmlld2Vy\
IGRlcGxveW1lbnQKICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVy\
czoKICAgIC0gbmFtZTogcHJvamVjdF9uYW1lCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRs\
ZTogUHJvamVjdCBOYW1lCiAgICAgIGRlZmF1bHQ6IGFyZW5kZXIKICAgICAgZGlzcGxheV9ncm91\
cDogUHJvamVjdCBwcm9wZXJ0aWVzCgogICAgLSBuYW1lOiBwcmV2aWV3ZXJfbnV4ZW9fdXJsCiAg\
ICAgIGRlZmF1bHQ6ICdodHRwczovL251eGVvLnVybC9udXhlbycKICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgIHRpdGxlOiBVcmwgb2YgdGhlIE51eGVvIGNsaWVudAogICAgICBkaXNwbGF5X2dyb3Vw\
OiBDbGllbnQgTnV4ZW8KICAgIC0gbmFtZTogcHJldmlld2VyX251eGVvX2NsaWVudF90aW1lb3V0\
CiAgICAgIGRlZmF1bHQ6IDYwCiAgICAgIHR5cGU6IG51bWJlcgogICAgICB0aXRsZTogVGltZW91\
dCBmb3IgdGhlIE51eGVvIENsaWVudAogICAgICBkaXNwbGF5X2dyb3VwOiBDbGllbnQgTnV4ZW8K\
ICAgIC0gbmFtZTogcHJldmlld2VyX2FyZW5kZXJfbWF4X3RyaWVzCiAgICAgIGRlZmF1bHQ6IDIK\
ICAgICAgdHlwZTogbnVtYmVyCiAgICAgIHRpdGxlOiBOdW1iZXIgb2YgcmV0cmllcyBmb3IgQVJl\
bmRlciBobWkgdG8gYXNrIGZvciBhIHJlbmRpdGlvbiBjYWxsCiAgICAgIGRpc3BsYXlfZ3JvdXA6\
IENsaWVudCBOdXhlbwogICAgLSBuYW1lOiBwcmV2aWV3ZXJfYXJlbmRlcl9yZXN0X2xvbmdfdGlt\
ZW91dAogICAgICBkZWZhdWx0OiA2MDAwMAogICAgICB0eXBlOiBudW1iZXIKICAgICAgdGl0bGU6\
IFRpbWVvdXQgZm9yIHJlbmRpdGlvbiBjYWxscyBtYWRlIGJ5IEFSZW5kZXIgaG1pCiAgICAgIGRp\
c3BsYXlfZ3JvdXA6IENsaWVudCBOdXhlbwogICAgLSBuYW1lOiBwcmV2aWV3ZXJfbnV4ZW9fb2F1\
dGhfc2VjcmV0CiAgICAgIGRlZmF1bHQ6ICdPQVVUSDJfU0VDUkVUJwogICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgdGl0bGU6IFNoYXJlZCBzZWNyZXQgZm9yIE9BdXRoMiBleGNoYW5nZQogICAgICBk\
aXNwbGF5X2dyb3VwOiBDbGllbnQgTnV4ZW8KCiAgICAtIG5hbWU6IGFyZW5kZXJfcmVuZGl0aW9u\
X3NlcnZpY2VfbmFtZQogICAgICBkZWZhdWx0OiBhcmVuZGVyLXBvb2wtMQogICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgdGl0bGU6IE5hbWUgb3IgdGhlIHJlbmRpdGlvbiBzZXJ2aWNlIHRvIHVzZQog\
ICAgICBkaXNwbGF5X2dyb3VwOiBBUmVuZGVyIFJlbmRpdGlvbiBCaW5kaW5nCgogICAgLSBuYW1l\
OiBhcmVuZGVyX3ByZXZpZXdlcl9pbWFnZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6\
IEFSZW5kZXIgcHJldmlld2VyIGltYWdlCiAgICAgIGRlZmF1bHQ6IGRvY2tlci1yZWdpc3RyeS5k\
ZWZhdWx0LnN2Yzo1MDAwL2NvbW1vbi1pbmZyYS9hcmVuZGVyLXByZXZpZXdlcgogICAgICBkaXNw\
bGF5X2dyb3VwOiBDb250YWluZXIgSW1hZ2UKICAgIC0gbmFtZTogYXJlbmRlcl9wcmV2aWV3ZXJf\
aW1hZ2VfdmVyc2lvbgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IEFSZW5kZXIgcHJl\
dmlld2VyIGltYWdlIHZlcnNpb24KICAgICAgZGVmYXVsdDogIjEwLjMuNSIKICAgICAgZGlzcGxh\
eV9ncm91cDogQ29udGFpbmVyIEltYWdlCgogICAgLSBuYW1lOiBhcmVuZGVyX3ByZXZpZXdlcl9p\
bWFnZV9wdWxsX2V4aXN0aW5nX3NlY3JldAogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6\
IE5hbWUgb2Ygc2VjcmV0IHRvIHVzZSB0byBwdWxsIGltYWdlIChMZWF2ZSBlbXB0eSBpZiB5b3V0\
IHdhbnQgdG8gdXNlIHVzZXIvcGFzc3dvcmQpCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5l\
ciBJbWFnZQogICAgLSBuYW1lOiBhcmVuZGVyX3ByZXZpZXdlcl9pbWFnZV9wdWxsX2hvc3QKICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBEb2NrZXIgcmVwb3NpdG9yeSB0byB1c2UgZm9y\
IHNlY3JldAogICAgICBkZWZhdWx0OiBkb2NrZXItcmVnaXN0cnkuZGVmYXVsdC5zdmM6NTAwMAog\
ICAgICBkaXNwbGF5X2dyb3VwOiBDb250YWluZXIgSW1hZ2UKICAgIC0gbmFtZTogYXJlbmRlcl9w\
cmV2aWV3ZXJfaW1hZ2VfcHVsbF91c2VybmFtZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0\
bGU6IFVzZXJuYW1lIHRvIHVzZSB0byBwdWxsIHRoZSBEb2NrZXIgaW1hZ2UKICAgICAgZGVmYXVs\
dDogbnV4ZW8KICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIEltYWdlCiAgICAtIG5hbWU6\
IGFyZW5kZXJfcHJldmlld2VyX2ltYWdlX3B1bGxfcGFzc3dvcmQKICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgIHRpdGxlOiBQYXNzd29yZCB0byB1c2UgdG8gcHVsbCB0aGUgRG9ja2VyIGltYWdlCiAg\
ICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVy\
IEltYWdlCgogICAgLSBuYW1lOiBwcmV2aWV3ZXJfaW1hZ2VfcHVsbFBvbGljeQogICAgICBkZWZh\
dWx0OiAnSWZOb3RQcmVzZW50JwogICAgICB0eXBlOiBlbnVtCiAgICAgIGVudW06IFsnSWZOb3RQ\
cmVzZW50JywgJ0Fsd2F5cycsICdOZXZlciddCiAgICAgIHRpdGxlOiBBUmVuZGVyIFByZXZpZXdl\
ciBpbWFnZSBwdWxsIHBvbGljeQogICAgICBkaXNwbGF5X2dyb3VwOiBDb250YWluZXIgU3BlY3MK\
CiAgICAtIG5hbWU6IHBlcnNpc3RlbnRWb2x1bWVfc3RvcmFnZUNsYXNzCiAgICAgIGRlZmF1bHQ6\
ICdzaGFyZWQnCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogU3RvcmFnZSBjbGFzc2Ug\
bmFtZSAobXVzdCBiZSBjYXBhYmxlIG9mIFJXWCkKICAgICAgZGlzcGxheV9ncm91cDogQ29udGFp\
bmVyIFNwZWNzCgogICAgLSBuYW1lOiBwcmV2aWV3ZXJfcmVzb3VyY2VzCiAgICAgIGRlZmF1bHQ6\
ICd7ImxpbWl0cyI6IHsiY3B1IjogIjIiLCJtZW1vcnkiOiAiNEdpIn0sInJlcXVlc3RzIjogeyJj\
cHUiOiAiMSIsIm1lbW9yeSI6ICIzR2kifX0nCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRs\
ZTogUHJldmlld2VyIFBvZCByZXNvdXJjZSByZXF1ZXN0cyBhbmQgbGltaXRzCiAgICAgIGRpc3Bs\
YXlfdHlwZTogdGV4dGFyZWEKICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIFNwZWNzCgog\
ICAgLSBuYW1lOiBhcmVuZGVyX3ByZXZpZXdlcl9oYQogICAgICBkZWZhdWx0OiBmYWxzZQogICAg\
ICB0eXBlOiBib29sZWFuCiAgICAgIHRpdGxlOiBFbmFibGUgSGlnaCBhdmFpbGFiaWxpdHkKICAg\
ICAgZGlzcGxheV9ncm91cDogQXV0b3NjYWxpbmcKCiAgICAtIG5hbWU6IGFyZW5kZXJfYXV0b3Nj\
YWxpbmdfbWluCiAgICAgIGRlZmF1bHQ6IDEKICAgICAgdHlwZTogbnVtYmVyCiAgICAgIHRpdGxl\
OiBBdXRvc2NhbGluZyBNaW5pbXVtIHJlcGxpY2FzCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEF1dG9z\
Y2FsaW5nCiAgICAtIG5hbWU6IGFyZW5kZXJfYXV0b3NjYWxpbmdfbWF4CiAgICAgIGRlZmF1bHQ6\
IDEKICAgICAgdHlwZTogbnVtYmVyCiAgICAgIHRpdGxlOiBBdXRvc2NhbGluZyBNYXhpbXVtIHJl\
cGxpY2FzCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEF1dG9zY2FsaW5nCiAgICAtIG5hbWU6IGFyZW5k\
ZXJfYXV0b3NjYWxpbmdfdGFyZ2V0Q1BVCiAgICAgIGRlZmF1bHQ6IDgwCiAgICAgIHR5cGU6IG51\
bWJlcgogICAgICB0aXRsZTogQXV0b3NjYWxpbmcgVGFyZ2V0IENQVSBVc2FnZSBwZXJjZW50YWdl\
CiAgICAgIGRpc3BsYXlfZ3JvdXA6IEF1dG9zY2FsaW5nCgogICAgLSBuYW1lOiBhcmVuZGVyX3By\
ZXZpZXdlcl9nd190aW1lb3V0X2luX3NlY29uZHMKICAgICAgZGVmYXVsdDogIjEyMHMiCiAgICAg\
IHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogR2F0ZXdheSB0aW1lb3V0CiAgICAgIGRpc3BsYXlf\
Z3JvdXA6IE90aGVycwoKICAgIC0gbmFtZTogYXJlbmRlcl9wcmV2aWV3ZXJfbW9uaXRvcmluZ19l\
bmFibGVkCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgIHR5cGU6IGJvb2xlYW4KICAgICAgZGlz\
cGxheV90eXBlOiBjaGVja2JveAogICAgICB0aXRsZTogRW5hYmxlIE1vbml0b3Jpbmcgc3RhY2sK\
ICAgICAgZGlzcGxheV9ncm91cDogTW9uaXRvcmluZwoKICAgIC0gbmFtZTogYXJlbmRlcl9wcmV2\
aWV3ZXJfbW9uaXRvcmluZ19lc19zZXJ2aWNlCiAgICAgIGRlZmF1bHQ6IGFyZW5kZXItbW9uaXRv\
ci1lbGFzdGljc2VhcmNoCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogTmFtZSBvZiB0\
aGUgRVMgc2VydmljZSBpbnN0YW5jZQogICAgICBkaXNwbGF5X2dyb3VwOiBNb25pdG9yaW5nCgog\
ICAgLSBuYW1lOiBhcmVuZGVyX3ByZXZpZXdlcl9tb25pdG9yaW5nX2tpYmFuYV9zZXJ2aWNlCiAg\
ICAgIGRlZmF1bHQ6IGFyZW5kZXItbW9uaXRvci1raWJhbmEKICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgIHRpdGxlOiBOYW1lIG9mIHRoZSBLaWJhbmEgc2VydmljZSBpbnN0YW5jZQogICAgICBkaXNw\
bGF5X2dyb3VwOiBNb25pdG9yaW5nCg=="

ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/nuxeo-arender-apb/
ADD . /opt/ansible/roles/nuxeo-arender-previewer-apb/

RUN chmod -R g=u /opt/{ansible,apb}

USER apb
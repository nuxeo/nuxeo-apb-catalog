FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBudXhlby1hcmVuZGVyLXJlbmRpdGlvbi1hcGIKZGVzY3Jp\
cHRpb246IEFSZW5kZXIgUmVuZGl0aW9uIGRlcGxveW1lbnQgaW4gT3BlbnNoaWZ0IGZvciBOdXhl\
bwpiaW5kYWJsZTogVHJ1ZQphc3luYzogb3B0aW9uYWwKdGFnczoKICAtIG51eGVvCiAgLSBudXhl\
by1hcmVuZGVyLXJlbmRpdGlvbgptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogQVJlbmRlciBSZW5k\
aXRpb24gZW52aXJvbm1lbnQgZm9yIE51eGVvCiAgaW1hZ2VVcmw6ICJodHRwczovL3d3dy5udXhl\
by5jb20vYXNzZXRzL2ltZ3MvbG9nbzM0MHg2MC5wbmciCiAgbG9uZ0Rlc2NyaXB0aW9uOgogICAg\
VGhpcyBEZXBsb3lzIGFuIEFSZW5kZXIgUmVuZGl0aW9uIGVudmlyb25tZW50IHRoYXQgY2FuIGJl\
IHVzZWQgd2l0aCBOdXhlbwogIGRlcGVuZGVuY2llczogW10KICBwcm92aWRlckRpc3BsYXlOYW1l\
OiAiTnV4ZW8iCnBsYW5zOgogIC0gbmFtZTogYnJpZGdlCiAgICBkZXNjcmlwdGlvbjogQnJpZGdl\
IHRvIGFub3RoZXIgZGVwbG95ZWQgYnJva2VyCiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YTog\
e30KICAgIHBhcmFtZXRlcnM6CiAgICAtIG5hbWU6IHByb2plY3RfbmFtZQogICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgdGl0bGU6IFByb2plY3QgTmFtZQogICAgICBkZWZhdWx0OiBhcmVuZGVyCiAg\
ICAgIGRpc3BsYXlfZ3JvdXA6IFByb2plY3QgcHJvcGVydGllcwogICAgLSBuYW1lOiBicm9rZXJf\
c2VydmljZV9kbnMKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBSZW1vdGUgYnJva2Vy\
IEROUwogICAgICBkZWZhdWx0OiBhcmVuZGVyLXBvb2wtMS1yZW5kaXRpb24tYnJva2VyLmludC1h\
cmVuZGVyLXByZXByb2Quc3ZjCiAgICAgIGRpc3BsYXlfZ3JvdXA6IFJlbW90ZSBicm9rZXIKICAg\
IC0gbmFtZTogYnJva2VyX3NlcnZpY2VfcG9ydAogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0\
bGU6IFJlbW90ZSBicm9rZXIgcG9ydAogICAgICBkZWZhdWx0OiAiODc2MSIKICAgICAgZGlzcGxh\
eV9ncm91cDogUmVtb3RlIGJyb2tlcgoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9u\
OiBEZWZhdWx0IEFSZW5kZXIgUmVuZGl0aW9uIGRlcGxveW1lbnQKICAgIGZyZWU6IHRydWUKICAg\
IG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczoKICAgIC0gbmFtZTogcHJvamVjdF9uYW1lCiAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogUHJvamVjdCBOYW1lCiAgICAgIGRlZmF1bHQ6\
IGFyZW5kZXIKICAgICAgZGlzcGxheV9ncm91cDogUHJvamVjdCBwcm9wZXJ0aWVzCgogICAgLSBu\
YW1lOiBhcmVuZGVyX3JlbmRpdGlvbl9pbWFnZV9yZWdpc3RyeQogICAgICB0eXBlOiBzdHJpbmcK\
ICAgICAgdGl0bGU6IEFSZW5kZXIgcmVuZGl0aW9uIGltYWdlCiAgICAgIGRlZmF1bHQ6IGRvY2tl\
ci1yZWdpc3RyeS5kZWZhdWx0LnN2Yzo1MDAwL2NvbW1vbi1pbmZyYQogICAgICBkaXNwbGF5X2dy\
b3VwOiBDb250YWluZXIgSW1hZ2UKICAgIC0gbmFtZTogYXJlbmRlcl9yZW5kaXRpb25faW1hZ2Vf\
dmVyc2lvbgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IEFSZW5kZXIgcmVuZGl0aW9u\
IGltYWdlCiAgICAgIGRlZmF1bHQ6ICI0LjAuOS5OWDEuMCIKICAgICAgZGlzcGxheV9ncm91cDog\
Q29udGFpbmVyIEltYWdlCiAgICAtIG5hbWU6IGFyZW5kZXJfcmVuZGl0aW9uX2ltYWdlX3B1bGxf\
ZXhpc3Rpbmdfc2VjcmV0CiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogTmFtZSBvZiBz\
ZWNyZXQgdG8gdXNlIHRvIHB1bGwgaW1hZ2UgKExlYXZlIGVtcHR5IGlmIHlvdXQgd2FudCB0byB1\
c2UgdXNlci9wYXNzd29yZCkKICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIEltYWdlCiAg\
ICAtIG5hbWU6IGFyZW5kZXJfcmVuZGl0aW9uX2ltYWdlX3B1bGxfdXNlcm5hbWUKICAgICAgdHlw\
ZTogc3RyaW5nCiAgICAgIHRpdGxlOiBVc2VybmFtZSB0byB1c2UgdG8gcHVsbCB0aGUgRG9ja2Vy\
IGltYWdlCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5lciBJbWFnZQogICAgLSBuYW1lOiBh\
cmVuZGVyX3JlbmRpdGlvbl9pbWFnZV9wdWxsX3Bhc3N3b3JkCiAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICB0aXRsZTogUGFzc3dvcmQgdG8gdXNlIHRvIHB1bGwgdGhlIERvY2tlciBpbWFnZQogICAg\
ICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5lciBJ\
bWFnZQoKICAgIC0gbmFtZTogYXJlbmRlcl9hdXRvc2NhbGluZ19taW4KICAgICAgZGVmYXVsdDog\
MQogICAgICB0eXBlOiBudW1iZXIKICAgICAgdGl0bGU6IEF1dG9zY2FsaW5nIE1pbmltdW0gcmVw\
bGljYXMKICAgICAgZGlzcGxheV9ncm91cDogQXV0b3NjYWxpbmcKICAgIC0gbmFtZTogYXJlbmRl\
cl9hdXRvc2NhbGluZ19tYXgKICAgICAgZGVmYXVsdDogMTAKICAgICAgdHlwZTogbnVtYmVyCiAg\
ICAgIHRpdGxlOiBBdXRvc2NhbGluZyBNYXhpbXVtIHJlcGxpY2FzCiAgICAgIGRpc3BsYXlfZ3Jv\
dXA6IEF1dG9zY2FsaW5nCiAgICAtIG5hbWU6IGFyZW5kZXJfYXV0b3NjYWxpbmdfdGFyZ2V0Q1BV\
CiAgICAgIGRlZmF1bHQ6IDgwCiAgICAgIHR5cGU6IG51bWJlcgogICAgICB0aXRsZTogQXV0b3Nj\
YWxpbmcgVGFyZ2V0IENQVSBVc2FnZSBwZXJjZW50YWdlCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEF1\
dG9zY2FsaW5nCgogICAgLSBuYW1lOiBhcmVuZGVyX2RvY3VtZW50X3NlcnZpY2VfYnJva2VyX3Jl\
c291cmNlcwogICAgICBkZWZhdWx0OiAneyJsaW1pdHMiOiB7ImNwdSI6ICIxIiwibWVtb3J5Ijog\
IjEuNUdpIn0sInJlcXVlc3RzIjogeyJjcHUiOiAiMSIsIm1lbW9yeSI6ICIxR2kifX0nCiAgICAg\
IHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogRG9jdW1lbnQgU2VydmljZSBCcm9rZXIgUG9kIHJl\
c291cmNlIHJlcXVlc3RzIGFuZCBsaW1pdHMKICAgICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQog\
ICAgICBkaXNwbGF5X2dyb3VwOiBDb250YWluZXIgU3BlY3MKICAgIC0gbmFtZTogYXJlbmRlcl9k\
b2N1bWVudF9jb252ZXJ0ZXJfcmVzb3VyY2VzCiAgICAgIGRlZmF1bHQ6ICd7ImxpbWl0cyI6IHsi\
Y3B1IjogIjEuNSIsIm1lbW9yeSI6ICI2R2kifSwicmVxdWVzdHMiOiB7ImNwdSI6ICIxIiwibWVt\
b3J5IjogIjRHaSJ9fScKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBEb2N1bWVudCBD\
b252ZXJ0ZXIgUG9kIHJlc291cmNlIHJlcXVlc3RzIGFuZCBsaW1pdHMKICAgICAgZGlzcGxheV90\
eXBlOiB0ZXh0YXJlYQogICAgICBkaXNwbGF5X2dyb3VwOiBDb250YWluZXIgU3BlY3MKICAgIC0g\
bmFtZTogYXJlbmRlcl9kb2N1bWVudF90ZXh0X2hhbmRsZXJfcmVzb3VyY2VzCiAgICAgIGRlZmF1\
bHQ6ICd7ImxpbWl0cyI6IHsiY3B1IjogIjEiLCJtZW1vcnkiOiAiMS41R2kifSwicmVxdWVzdHMi\
OiB7ImNwdSI6ICIxIiwibWVtb3J5IjogIjFHaSJ9fScKICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
IHRpdGxlOiBEb2N1bWVudCBUZXh0IEhhbmRsZXIgUG9kIHJlc291cmNlIHJlcXVlc3RzIGFuZCBs\
aW1pdHMKICAgICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAgICBkaXNwbGF5X2dyb3VwOiBD\
b250YWluZXIgU3BlY3MKICAgIC0gbmFtZTogYXJlbmRlcl9kb2N1bWVudF9yZW5kZXJlcl9yZXNv\
dXJjZXMKICAgICAgZGVmYXVsdDogJ3sibGltaXRzIjogeyJjcHUiOiAiMiIsIm1lbW9yeSI6ICI2\
R2kifSwicmVxdWVzdHMiOiB7ImNwdSI6ICIyIiwibWVtb3J5IjogIjRHaSJ9fScKICAgICAgdHlw\
ZTogc3RyaW5nCiAgICAgIHRpdGxlOiBEb2N1bWVudCBSZW5kZXJlciBQb2QgcmVzb3VyY2UgcmVx\
dWVzdHMgYW5kIGxpbWl0cwogICAgICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgIGRpc3Bs\
YXlfZ3JvdXA6IENvbnRhaW5lciBTcGVjcwogICAgLSBuYW1lOiBhcmVuZGVyX2RvY3VtZW50X2Zp\
bGVfc3RvcmFnZV9yZXNvdXJjZXMKICAgICAgZGVmYXVsdDogJ3sibGltaXRzIjogeyJjcHUiOiAi\
MSIsIm1lbW9yeSI6ICIxLjVHaSJ9LCJyZXF1ZXN0cyI6IHsiY3B1IjogIjEiLCJtZW1vcnkiOiAi\
MUdpIn19JwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IERvY3VtZW50IEZpbGUgU3Rv\
cmFnZSBQb2QgcmVzb3VyY2UgcmVxdWVzdHMgYW5kIGxpbWl0cwogICAgICBkaXNwbGF5X3R5cGU6\
IHRleHRhcmVhCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5lciBTcGVjcwogICAgLSBuYW1l\
OiBwZXJzaXN0ZW50Vm9sdW1lX3N0b3JhZ2VDbGFzcwogICAgICBkZWZhdWx0OiAnc2hhcmVkJwog\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IFN0b3JhZ2UgY2xhc3NlIG5hbWUgKG11c3Qg\
YmUgY2FwYWJsZSBvZiBSV1gpCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5lciBTcGVjcwoK\
ICAgIC0gbmFtZTogYXJlbmRlcl9kZWJ1Z19wb2QKICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAg\
dHlwZTogYm9vbGVhbgogICAgICBkaXNwbGF5X3R5cGU6IGNoZWNrYm94CiAgICAgIHRpdGxlOiBE\
ZXBsb3kgYSBkZWJ1ZyBwb2QKICAgICAgZGlzcGxheV9ncm91cDogT3RoZXJzCgogICAgLSBuYW1l\
OiBhcmVuZGVyX3JlbmRpdGlvbl9pbWFnZW1hZ2lja19vcHRpb25zCiAgICAgIGRlZmF1bHQ6ICct\
cXVhbGl0eSwxMDAsLWRlbnNpdHksNzJ4NzIsLXVuaXRzLFBpeGVsc1BlckluY2gsLWF1dG8tb3Jp\
ZW50LCtyZXBhZ2UnCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogT3B0aW9ucyBwYXNz\
ZWQgdG8gSW1hZ2UgTWFnaWNrIGZvciBjb252ZXJzaW9ucwogICAgICBkaXNwbGF5X2dyb3VwOiBB\
UmVuZGVyIGNvbmZpZ3VyYXRpb24KCiAgICAtIG5hbWU6IGFyZW5kZXJfcmVuZGl0aW9uX2NvbnZl\
cnNpb25fdGltZW91dAogICAgICBkZWZhdWx0OiAyNDAKICAgICAgdHlwZTogbnVtYmVyCiAgICAg\
IHRpdGxlOiBUaW1lb3V0IGZvciBjb252ZXJzaW9uCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEFSZW5k\
ZXIgY29uZmlndXJhdGlvbgoKICAgIC0gbmFtZTogYXJlbmRlcl9yZW5kaXRpb25fbW9uaXRvcmlu\
Z19lbmFibGVkCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgICAgdHlwZTogYm9vbGVhbgogICAgICBk\
aXNwbGF5X3R5cGU6IGNoZWNrYm94CiAgICAgIHRpdGxlOiBFbmFibGUgTW9uaXRvcmluZyBzdGFj\
awogICAgICBkaXNwbGF5X2dyb3VwOiBNb25pdG9yaW5nCgogICAgLSBuYW1lOiBhcmVuZGVyX3Jl\
bmRpdGlvbl9tb25pdG9yaW5nX2VzX3NlcnZpY2UKICAgICAgZGVmYXVsdDogYXJlbmRlci1tb25p\
dG9yLWVsYXN0aWNzZWFyY2gKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBOYW1lIG9m\
IHRoZSBFUyBzZXJ2aWNlIGluc3RhbmNlCiAgICAgIGRpc3BsYXlfZ3JvdXA6IE1vbml0b3JpbmcK\
CiAgICAtIG5hbWU6IGFyZW5kZXJfcmVuZGl0aW9uX21vbml0b3Jpbmdfa2liYW5hX3NlcnZpY2UK\
ICAgICAgZGVmYXVsdDogYXJlbmRlci1tb25pdG9yLWtpYmFuYQogICAgICB0eXBlOiBzdHJpbmcK\
ICAgICAgdGl0bGU6IE5hbWUgb2YgdGhlIEtpYmFuYSBzZXJ2aWNlIGluc3RhbmNlCiAgICAgIGRp\
c3BsYXlfZ3JvdXA6IE1vbml0b3JpbmcKCg=="


ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/nuxeo-arender-apb/
ADD . /opt/ansible/roles/nuxeo-arender-rendition-apb/

RUN chmod -R g=u /opt/{ansible,apb}

USER apb